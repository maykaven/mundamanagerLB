@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Light theme reference values */
    --light-background: 0 0% 100%;
    --light-foreground: 0 0% 3.9%;
    --light-card: 0 0% 100%;
    --light-card-foreground: 0 0% 3.9%;
    --light-popover: 0 0% 100%;
    --light-popover-foreground: 0 0% 3.9%;
    --light-primary: 0 0% 9%;
    --light-primary-foreground: 0 0% 98%;
    --light-secondary: 0 0% 100%;
    --light-secondary-foreground: 0 0% 9%;
    --light-muted: 0 0% 96.1%;
    --light-muted-foreground: 220 14% 34%;
    --light-accent: 0 0% 96.1%;
    --light-accent-foreground: 0 0% 9%;
    --light-destructive: 0 84.2% 60.2%;
    --light-destructive-foreground: 0 0% 98%;
    --light-border: 0 0% 89.8%;
    --light-input: 0 0% 89.8%;
    --light-ring: 0 0% 3.9%;

    /* Current theme values (default to light) */
    --background: var(--light-background);
    --foreground: var(--light-foreground);
    --card: var(--light-card);
    --card-foreground: var(--light-card-foreground);
    --popover: var(--light-popover);
    --popover-foreground: var(--light-popover-foreground);
    --primary: var(--light-primary);
    --primary-foreground: var(--light-primary-foreground);
    --secondary: var(--light-secondary);
    --secondary-foreground: var(--light-secondary-foreground);
    --muted: var(--light-muted);
    --muted-foreground: var(--light-muted-foreground);
    --accent: var(--light-accent);
    --accent-foreground: var(--light-accent-foreground);
    --destructive: var(--light-destructive);
    --destructive-foreground: var(--light-destructive-foreground);
    --border: var(--light-border);
    --input: var(--light-input);
    --ring: var(--light-ring);
    --radius: 0.5rem;
  }

  .dark {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;
    --card: 0 0% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;
    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;
    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 11.9%;
    --input: 0 0% 11.9%;
    --ring: 0 0% 83.1%;
  }

  /* Fix select option styling for dark mode */
  .dark select option {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }

  /* Hive theme - grimdark Necromunda aesthetic */
  .hive {
    --background: 0 0% 4%;            /* #0a0a0a hive-black */
    --foreground: 0 0% 96%;           /* #f5f5f5 hive-white */
    --card: 0 0% 8%;                  /* #141414 hive-dark */
    --card-foreground: 0 0% 96%;      /* #f5f5f5 hive-white */
    --popover: 0 0% 8%;               /* #141414 hive-dark */
    --popover-foreground: 0 0% 96%;   /* #f5f5f5 hive-white */
    --primary: 0 100% 27%;            /* #8b0000 hive-red */
    --primary-foreground: 0 0% 96%;   /* #f5f5f5 hive-white */
    --secondary: 0 0% 12%;            /* #1f1f1f hive-mid */
    --secondary-foreground: 0 0% 75%; /* #c0c0c0 hive-silver */
    --muted: 0 0% 12%;               /* #1f1f1f hive-mid */
    --muted-foreground: 0 0% 49%;    /* #71797E hive-steel */
    --accent: 0 100% 21%;            /* #6b0000 hive-accent */
    --accent-foreground: 0 0% 96%;   /* #f5f5f5 hive-white */
    --destructive: 0 100% 15%;       /* #4a0000 hive-blood */
    --destructive-foreground: 0 0% 96%;
    --border: 0 0% 17%;              /* #2a2a2a hive-light */
    --input: 0 0% 17%;               /* #2a2a2a hive-light */
    --ring: 0 100% 27%;              /* #8b0000 hive-red focus rings */
  }

  .hive select option {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
  img {
    @apply inline-block;
  }

  .table-weapons-truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%; /* Ensures it respects the parent's width */
  }

  @media (max-width: 1024px) {
    .table-weapons-truncate {
      max-width: 14rem; /* Adjust width for medium screens */
    }
  }

  @media (max-width: 768px) {
    .table-weapons-truncate {
      max-width: 12rem; /* Smaller width for smaller screens */
    }
  }

  @media (max-width: 640px) {
    .table-weapons-truncate {
      max-width: 7rem; /* Truncate more on very small screens */
    }
  }

  @media (max-width: 440px) {
    .table-weapons-truncate {
      max-width: 5rem; /* Truncate more on very small screens */
    }
  }

  @media print {
    @page {
      margin: 8mm;  /* this affects the margin in the printer settings */
    }

    /* Force light theme colors when printing by referencing the original light theme values */
    :root,
    .dark,
    .hive {
      --background: var(--light-background) !important;
      --foreground: var(--light-foreground) !important;
      --card: var(--light-card) !important;
      --card-foreground: var(--light-card-foreground) !important;
      --popover: var(--light-popover) !important;
      --popover-foreground: var(--light-popover-foreground) !important;
      --primary: var(--light-primary) !important;
      --primary-foreground: var(--light-primary-foreground) !important;
      --secondary: var(--light-secondary) !important;
      --secondary-foreground: var(--light-secondary-foreground) !important;
      --muted: var(--light-muted) !important;
      --muted-foreground: var(--light-muted-foreground) !important;
      --accent: var(--light-accent) !important;
      --accent-foreground: var(--light-accent-foreground) !important;
      --destructive: var(--light-destructive) !important;
      --destructive-foreground: var(--light-destructive-foreground) !important;
      --border: var(--light-border) !important;
      --input: var(--light-input) !important;
      --ring: var(--light-ring) !important;
    }

    .print-reset {
      max-width: none !important;
      width: auto !important;
      padding: 0 !important;
    }
    .print-fighter-card {
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
      width: 630px;
      height: 435px;
      break-inside: avoid !important;
      display: inline-block; /* ios workaround for break-inside: avoid */
      background-image: none !important;
      background-color: transparent !important;
      box-shadow: none !important;
      border-width: 3px !important; /* Firefox workaround when printing borders less than border-4 in tailwind */
      margin-right: 6px !important;
    }
    .print-fighters {
      zoom: 0.55;
    }
    .print-gang-roster {
      zoom: 0.88;
    }
    .table-weapons th, .table-weapons td {
      padding: 1px !important;
      padding-left: 2px !important;
    }
    .table-weapons-truncate {
      max-width: 10rem; /* Smaller width for smaller screens */
    }

    body.fancy-print .fighter-card-bg.print-fighter-card {
      background-image: url('https://iojoritxhpijprgkjfre.supabase.co/storage/v1/object/public/site-images/fighter-card-background-5-light_web_ynpbac.webp') !important;
      background-color: #faf9f7 !important;
    }

    body.fancy-print .fancy-print-top-bar {
      background-image: url('https://iojoritxhpijprgkjfre.supabase.co/storage/v1/object/public/site-images/top-bar-stroke-v3_s97f2k.png') !important;
    }

    body.fancy-print .fancy-print-keep-color-heading {
      color: #ffffff !important;
    }

    body.fancy-print .fancy-print-keep-color-subtitle {
      color: #d1d5db !important;
    }

    html {
      zoom: 1;
    }
  }
}

/* Fighter card background images for light and dark themes */
.fighter-card-bg {
  background-image: url('https://iojoritxhpijprgkjfre.supabase.co/storage/v1/object/public/site-images/fighter-card-background-5-light_web_ynpbac.webp');
}

.dark .fighter-card-bg {
  background-image: url('https://iojoritxhpijprgkjfre.supabase.co/storage/v1/object/public/site-images/fighter-card-background-5-dark_web_lhh1dn.webp');
}

.hive .fighter-card-bg {
  background-image: url('https://iojoritxhpijprgkjfre.supabase.co/storage/v1/object/public/site-images/fighter-card-background-5-dark_web_lhh1dn.webp');
}

/* Hive theme scrollbar */
.hive ::-webkit-scrollbar-track {
  background: #141414;
}
.hive ::-webkit-scrollbar-thumb {
  background: #6b0000;
}
.hive ::-webkit-scrollbar-thumb:hover {
  background: #8b0000;
}

/* Prevent hover effects from sticking on touch devices */
@media (hover: none) and (pointer: coarse) {
  .fighter-card-bg:hover {
    transform: none !important;
    box-shadow: none !important;
  }
  
  .fighter-card-bg:hover * {
    transform: none !important;
  }
}

/* tailwindcss fix for Firefox */
@layer base {
  option, optgroup {
    font-family: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    font-feature-settings: normal;
    font-variation-settings: normal;
    font-size: 100%;
    font-weight: 400;
    line-height: normal;
    color: #0a0a0a;
  }
}
